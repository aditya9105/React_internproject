<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>View Database</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- AG Grid styles -->
<link href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-grid.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-theme-alpine.css" rel="stylesheet">

<style>
#root {
  margin-top: 20px;
}
</style>
</head>

<body>
<div class="container mt-4">
  <a href="index.html" class="btn btn-primary mb-3">â¬… Back to Main Page</a>
</div>

<div class="container">
  <div id="myGrid" class="ag-theme-alpine" style="height: 600px; width: 100%;"></div>
</div>

<script type="module" src="script.js"></script>

<!-- React & Babel -->
<script src="https://unpkg.com/react@17/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

<!-- AG Grid -->
<script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.noStyle.js"></script>

<script type="text/babel">
const { useEffect } = React;

function App() {
  useEffect(() => {
    const gridDiv = document.querySelector('#myGrid');

    window.listenToFirebase((entries) => {
      const columnDefs = [
        { headerName: "First Name", field: "name", sortable: true, filter: true },
        { headerName: "Last Name", field: "lastName", sortable: true, filter: true },
        { headerName: "Email", field: "email", sortable: true, filter: true },
        { headerName: "Mobile", field: "mobile", sortable: true, filter: true },
        { headerName: "Company", field: "company", sortable: true, filter: true },
        { headerName: "DOB", field: "dob", sortable: true, filter: true },
        { headerName: "Gender", field: "gender", sortable: true, filter: true },
        { headerName: "Image", field: "selectedImage", cellRenderer: (params) => {
            return `<img src="${params.value}" style="width:40px;height:40px;object-fit:cover;">`
        }},
        { headerName: "Actions", cellRenderer: (params) => {
            return `
              <a href="index.html?id=${params.data.id}" class="btn btn-sm btn-primary">Update</a>
              <button class="btn btn-sm btn-danger" onclick="confirmAndDelete('${params.data.id}')">Delete</button>
            `;
        }}
      ];

      const gridOptions = {
        columnDefs,
        rowData: entries,
        defaultColDef: {
          resizable: true,
          sortable: true,
          filter: true
        }
      };

      new agGrid.Grid(gridDiv, gridOptions);
    });
  }, []);

  return null;
}

ReactDOM.render(<App />, document.getElementById("myGrid"));
</script>
</body>
</html>
